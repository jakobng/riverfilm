<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mouthful of River – Flow Map</title>
  <style>
    body{font-family:"Inter",sans-serif;margin:0;padding:0;display:flex;flex-direction:column;align-items:center;background:#fafafa}
    h1{margin:1rem 0 0.25rem 0}
    #graph{width:100%;height:80vh;border:0;background:linear-gradient(180deg,#d0eef7 0%,#a8dff1 60%,#7ac7de 100%);border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.12)}
    @media (max-width:600px){h1{font-size:1.25rem}}
  </style>
  <script src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
</head>
<body>
  <h1>Mouthful of River – Flow Map</h1>
  <p style="margin:0 0 0.5rem 0;font-size:0.9rem;">Hover a concept to trace how ideas flow downstream into projects & scenes.</p>
  <div id="graph"></div>

  <script>
    /*========== Nodes ==========*/
    const nodes = new vis.DataSet([
      // Central source (now circle)
      { id:0,label:'Mouthful of River',shape:'dot',size:30,color:{background:'#ffe082',border:'#ffca28'},font:{size:22,bold:true},url:'/blog/mouthful-of-river',originalColor:{background:'#ffe082',border:'#ffca28'}},

      // First ring – main projects
      { id:1,label:'Tayal Listening',shape:'dot',size:22,color:'#2ecc71',url:'/blog/tayal-listening',originalColor:'#2ecc71'},
      { id:2,label:'Data‑centre Activism',shape:'dot',size:22,color:'#e74c3c',url:'/blog/data-centre-activism',originalColor:'#e74c3c'},
      { id:3,label:'UK River Rights',shape:'dot',size:22,color:'#3498db',url:'/blog/uk-river-rights',originalColor:'#3498db'},
      { id:4,label:'Artistic Listening',shape:'dot',size:22,color:'#9b59b6',url:'/blog/artistic-listening',originalColor:'#9b59b6'},
      { id:5,label:'Scientific Listening',shape:'dot',size:22,color:'#f1c40f',url:'/blog/scientific-listening',originalColor:'#f1c40f'},

      // Tayal details
      { id:11,label:'Tayal Song of Interdependence',shape:'dot',size:14,color:'#27ae60',url:'/blog/tayal-song',originalColor:'#27ae60'},
      { id:12,label:'Tayal Water Governance',shape:'dot',size:14,color:'#27ae60',url:'/blog/tayal-water-governance',originalColor:'#27ae60'},
      { id:13,label:'Tsou River Chatbot',shape:'dot',size:14,color:'#27ae60',url:'/blog/tsou-river-chatbot',originalColor:'#27ae60'},

      // Data‑centre details
      { id:21,label:'Tu Nube Seca Mi Río',shape:'dot',size:14,color:'#c0392b',url:'/blog/tu-nube-seca',originalColor:'#c0392b'},
      { id:22,label:'Le Nuage était…',shape:'dot',size:14,color:'#c0392b',url:'/blog/le-nuage',originalColor:'#c0392b'},
      { id:23,label:'WaterWatch Oregon',shape:'dot',size:14,color:'#c0392b',url:'/blog/waterwatch-oregon',originalColor:'#c0392b'},

      // UK river rights details
      { id:31,label:'River Ouse Legal Rights',shape:'dot',size:14,color:'#2980b9',url:'/blog/river-ouse-rights',originalColor:'#2980b9'},
      { id:32,label:'River Don Chatbot',shape:'dot',size:14,color:'#2980b9',url:'/blog/river-don-chatbot',originalColor:'#2980b9'},
      { id:33,label:'Living Stewardship Agreement',shape:'dot',size:14,color:'#2980b9',url:'/blog/living-stewardship',originalColor:'#2980b9'},

      // Artistic details
      { id:41,label:'CLAMS Sculpture',shape:'dot',size:14,color:'#8e44ad',url:'/blog/clams-sculpture',originalColor:'#8e44ad'},
      { id:42,label:'Amor Núñez – CORPUS AQUAE',shape:'dot',size:14,color:'#8e44ad',url:'/blog/corpus-aquae',originalColor:'#8e44ad'},
      { id:43,label:'Generative River Score',shape:'dot',size:14,color:'#8e44ad',url:'/blog/generative-score',originalColor:'#8e44ad'},

      // Scientific details
      { id:51,label:'Dr Atakan Aral Networks',shape:'dot',size:14,color:'#d4ac0d',url:'/blog/atakan-aral',originalColor:'#d4ac0d'},
      { id:52,label:'Hydrophones Expedition',shape:'dot',size:14,color:'#d4ac0d',url:'/blog/hydrophones-taiwan',originalColor:'#d4ac0d'},

      // Conceptual nodes (outer ring) – now circles too
      { id:101,label:'More‑than‑Human Alignment',shape:'dot',size:20,color:'#ff7f0e',font:{bold:true},url:'/blog/ai-alignment-more-than-human',originalColor:'#ff7f0e'},
      { id:102,label:'Plurality / Digital Democracy',shape:'dot',size:20,color:'#16a085',font:{bold:true},url:'/blog/plural-digital-democracy',originalColor:'#16a085'}
    ]);

    /*========== Edges ==========*/
    const edges = new vis.DataSet([
      {from:0,to:1,width:2,smooth:{type:'continuous'}},
      {from:0,to:2,width:2,smooth:{type:'continuous'}},
      {from:0,to:3,width:2,smooth:{type:'continuous'}},
      {from:0,to:4,width:2,smooth:{type:'continuous'}},
      {from:0,to:5,width:2,smooth:{type:'continuous'}},
      // Tayal tributaries
      {from:1,to:11,width:1},{from:1,to:12,width:1},{from:1,to:13,width:1},
      // Data‑centre tributaries
      {from:2,to:21,width:1},{from:2,to:22,width:1},{from:2,to:23,width:1},
      // UK river rights
      {from:3,to:31,width:1},{from:3,to:32,width:1},{from:3,to:33,width:1},
      // Artistic listening
      {from:4,to:41,width:1},{from:4,to:42,width:1},{from:4,to:43,width:1},
      // Scientific listening
      {from:5,to:51,width:1},{from:5,to:52,width:1}
    ]);

    /*========== Layout & Physics ==========*/
    const container=document.getElementById('graph');
    const data={nodes,edges};
    const options={
      interaction:{hover:true,zoomView:true,dragView:true,tooltipDelay:100},
      physics:{
        enabled:true,
        solver:'forceAtlas2Based',
        forceAtlas2Based:{springLength:220,gravitationalConstant:-120},
        minVelocity:0.75,
        stabilization:{iterations:250},
      },
      edges:{color:{color:'#0e385b'},smooth:{type:'cubicBezier',roundness:0.4}},
      nodes:{borderWidth:0,font:{color:'#0e385b'}}
    };
    const network=new vis.Network(container,data,options);

    /*========== Click opens URL ==========*/
    network.on('click',p=>{if(p.nodes.length){const n=nodes.get(p.nodes[0]);if(n.url)window.open(n.url,'_blank');}});

    /*========== Hover-highlight for concepts ==========*/
    const conceptLinks={
      101:[32,33,51,13,11,41,42,43],
      102:[23,21,22,31,32,33,12,13]
    };
    let dimmed=false;
    function dimAll(){
      nodes.forEach(n=>nodes.update({id:n.id,color:{background:'#b6d7e1'},font:{color:'#8cb3bd'}}));
      dimmed=true;
    }
    function restoreAll(){
      nodes.forEach(n=>nodes.update({id:n.id,color:n.originalColor,font:{color:'#0e385b'}}));
      dimmed=false;
    }
    function highlight(id){
      if(!conceptLinks[id])return;
      if(!dimmed)dimAll();
      [id,...conceptLinks[id],0,1,2,3,4,5].forEach(t=>{
        const n=nodes.get(t);
        nodes.update({id:t,color:n.originalColor,font:{color:'#0e385b'}});
      });
    }
    network.on('hoverNode',p=>{if(conceptLinks[p.node])highlight(p.node);});
    network.on('blurNode',p=>{if(conceptLinks[p.node])restoreAll();});
  </script>
</body>
</html>
